<html>

<body>
    <script src="bundle.js"></script>
    <script>
        function getRandomInteger(min, max) {
            return Math.floor(Math.random() * (max - min)) + min;
        }
        window.writtenNumber.defaults = { noAnd: false, alternativeBase: null, lang: "es" }
        max = 100
        number = getRandomInteger(0, max)

        // on window start
        window.addEventListener('DOMContentLoaded', (event) => {
            document.getElementById("esRadio").checked = true
            document.getElementById("enRadio").checked = false
            document.getElementById("language").innerText = "Espanol"
            document.getElementById("targetNumber").innerText = number
            document.getElementById("results").style = "display:none"
            
            // listen to change in language selection
            document.getElementById("enRadio").addEventListener("click", () => {
                document.getElementById("esRadio").checked = false
                document.getElementById("enRadio").checked = true
                document.getElementById("language").innerText = "English"
                window.writtenNumber.defaults = { noAnd: false, alternativeBase: null, lang: "en" }
            });
            document.getElementById("esRadio").addEventListener("click", () => {
                document.getElementById("esRadio").checked = true
                document.getElementById("enRadio").checked = false
                document.getElementById("language").innerText = "Espanol"
                window.writtenNumber.defaults = { noAnd: false, alternativeBase: null, lang: "es" }
            });

            // listen for enter key when answering
            document.getElementById("userAnswer").addEventListener("keydown", (e) => {
                
                var key = window.event.keyCode;
                if (key == 13){ // 13 = enter key code
                    e.preventDefault()
                    document.getElementById("submit").click()
                }
            });

            // listen for submit button to check answer
            document.getElementById("submit").addEventListener("click", () => {
                document.getElementById("results").style = ""

                userAnswer = document.getElementById("userAnswer").value.replaceAll("-"," ").normalize('NFD').replace(/[\u0300-\u036f]/g, "")
                expectedAnswer = window.writtenNumber(number).replaceAll("-"," ").normalize('NFD').replace(/[\u0300-\u036f]/g, "")
                document.getElementById("usersAnswer").innerText = userAnswer
                document.getElementById("actualAnswer").innerText = expectedAnswer

                console.log(userAnswer)
                console.log(expectedAnswer)
                console.log(userAnswer == expectedAnswer)

                if (userAnswer == expectedAnswer){
                    document.getElementById("successOrFail").innerText = "CORRECT"
                }
                else{
                    document.getElementById("successOrFail").innerText = "INCORRECT"
                }

                // set new number
                document.getElementById("oldNumber").innerText = number
                number = getRandomInteger(0, max)
                document.getElementById("targetNumber").innerText = number

                // reset answer
                document.getElementById("userAnswer").value = ""
            });

            // change the difficulty
            document.getElementById("difficulty").addEventListener("change", () => {
                selected = document.getElementById("difficulty").selectedIndex
                switch (selected) {
                    case 0:
                        max = 100
                        break
                    case 1:
                        max = 10000
                        break
                    case 2:
                        max = 1000000
                        break
                    case 3:
                        max = 100000000
                        break
                    default:
                        break
                }
                number = getRandomInteger(0, max)
                document.getElementById("targetNumber").innerText = number
            });
        })

    </script>

    <input type="radio" id="enRadio" value="en">English</input><br />
    <input type="radio" id="esRadio" value="es">Espanol</input>
    <br /><br /><br />
    Difficulty:
    <select id="difficulty" multiple>
        <option value="easy">Easy (0-100)</option>
        <option value="medium">Medium (0-10,000)</option>
        <option value="hard">Hard (0-1,000,000)</option>
        <option value="super hard">Super Hard (0-100,000,000)</option>
    </select>
    <br /><br />
    <p>Write <span id="targetNumber"></span> in <span id="language">Espanol</span></p>
    <textarea id="userAnswer"></textarea>
    <button id="submit">Submit Answer</button>
    <br/><br/><hr/>
    <div id="results">Result (<span id="oldNumber"></span>): <span id="successOrFail"></span>
    <p> &nbsp;&nbsp;&nbsp;Your Answer: <span id="usersAnswer"></span></p>
    <p> Actual Answer: <span id="actualAnswer"></span></p>
    </div>
</body>

</html>