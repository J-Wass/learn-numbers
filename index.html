<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <script src="bundle.js"></script>
    <script>
        function getRandomInteger(min, max) {
            return Math.floor(Math.random() * (max - min)) + min;
        }
        window.writtenNumber.defaults = { noAnd: false, alternativeBase: null, lang: "es" }
        max = 100
        number = getRandomInteger(0, max)

        function setDifficulty() {
            selected = document.getElementById("difficulty").selectedIndex
            switch (selected) {
                case 0:
                    max = 10
                    break
                case 1:
                    max = 100
                    break
                case 2:
                    max = 100000
                    break
                case 3:
                    max = 999999999
                    break
                default:
                    break
            }
            number = getRandomInteger(0, max)
            document.getElementById("targetNumber").innerText = number
        }

        function setLanguage() {
            selected_lang_option = document.getElementById("languages").selectedOptions[0]
            selected_lang = selected_lang_option.text
            select_lang_code = selected_lang_option.value
            document.getElementById("language").innerText = selected_lang
            window.writtenNumber.defaults = { noAnd: false, alternativeBase: null, lang: select_lang_code }
        }

        // on window start
        window.addEventListener('DOMContentLoaded', (event) => {
            setDifficulty()
            setLanguage()

            document.getElementById("results").style = "display:none"

            // listen to change in language selection
            document.getElementById("languages").addEventListener("change", () => {
                setLanguage()
            })

            // listen for enter key when answering
            document.getElementById("userAnswer").addEventListener("keydown", (e) => {

                var key = window.event.keyCode;
                if (key == 13) { // 13 = enter key code
                    e.preventDefault()
                    document.getElementById("submit").click()
                }
            });

            // listen for submit button to check answer
            document.getElementById("submit").addEventListener("click", () => {
                document.getElementById("results").style = ""

                // normalize to remove accents
                userAnswer = document.getElementById("userAnswer").value.replaceAll("-", " ").normalize('NFD').replace(/[\u0300-\u036f]/g, "")
                expectedAnswer = window.writtenNumber(number).replaceAll("-", " ").normalize('NFD').replace(/[\u0300-\u036f]/g, "")

                // set answers so user can see them
                document.getElementById("usersAnswer").innerText = userAnswer
                document.getElementById("actualAnswer").innerText = expectedAnswer

                if (userAnswer == expectedAnswer) {
                    document.getElementById("successOrFail").innerText = "CORRECT"
                    document.getElementById("successOrFail").style = "color:green"
                }
                else {
                    document.getElementById("successOrFail").innerText = "INCORRECT"
                    document.getElementById("successOrFail").style = "color:red"
                }

                console.log(userAnswer)
                console.log(expectedAnswer)
                console.log(userAnswer == expectedAnswer)

                // set new number
                document.getElementById("oldNumber").innerText = number
                number = getRandomInteger(0, max)
                document.getElementById("targetNumber").innerText = number

                // reset answer
                document.getElementById("userAnswer").value = ""
            });

            // change the difficulty
            document.getElementById("difficulty").addEventListener("change", () => {
                setDifficulty()
            });
        })

    </script>

    <label for="languages">Choose a language:</label>
    <select name="languages" id="languages">
        <option value="en">English (Standard)</option>
        <option value="enIndian">English (India)</option>
        <option value="pt">Português (Brazil)</option>
        <option value="ptPT">Português (Portugal)</option>
        <option value="es">Español</option>
        <option value="fr">Français </option>
        <option value="eo">Esperanto</option>
        <option value="vi">Tiếng Việt</option>
        <option value="ar">العربية الفصحى</option>
        <option value="az">Азәрбајҹан дили</option>
        <option value="tr">Türkçe</option>
        <option value="uk">українська мова</option>
        <option value="id">Bahasa Indonesia</option>
        <option value="ru">Русский язык</option>
    </select>

    <br /><br />
    <label for="difficulty">Choose a difficulty:</label>
    <select name="difficulty" id="difficulty">
        <option value="easy">Basic (0-10)</option>
        <option value="medium">Easy (0-100)</option>
        <option value="hard">Medium (0-100,000)</option>
        <option value="super hard">Hard (0-999,999,999)</option>
    </select>
    <br /><br />
    <hr />
    <p>Write <span id="targetNumber"></span> in <span id="language">Espanol</span></p>
    <textarea id="userAnswer" style="width:50%;max-width:100%;min-width:300px" rows="2"></textarea><br /><br />
    <button id="submit">Submit Answer</button>
    <br /><br />
    <hr />
    <div id="results">
        <span id="successOrFail"></span> (<span id="oldNumber"></span>)

        <p> Actual Answer: <span id="actualAnswer"></span></p>
        <p> &nbsp;&nbsp;&nbsp;Your Answer: <span id="usersAnswer"></span></p>
    </div>
</body>
<br />
<a target="_blank" href="https://github.com/J-Wass/learn-numbers">Github</a>

</html>